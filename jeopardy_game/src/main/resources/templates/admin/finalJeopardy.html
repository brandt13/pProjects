<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org" xmlns:align="http://www.w3.org/1999/xhtml"
      xmlns:style="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/html"
      xmlns="http://www.w3.org/1999/html">

<head>
    <title>Final Jeopardy</title>
    <link rel="stylesheet" type="text/css" th:href="@{/css/home.css}" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script	src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>

<body>
<div class="container">

    <form th:action="@{/logout}" method="get">
        <button class="btn btn-md btn-danger btn-block" name="logout"
                type="Submit">Logout</button>
    </form>

    <div class="panel-group" style="margin-top:40px">
        <div class="panel panel-info">
            <div class="panel-heading">
                <span th:utext="${welcome}"></span>
            </div>
            <div class="panel-body">
                <table align="center" class="t1">

                    <style>
                        table.t1 {
                            border: 2px solid black;
                            padding: 12px;
                            table-layout: fixed;
                            text-align: center;
                            width: 100%;
                            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
                            font-size: 14px;
                            font-style: bold;
                            font-variant: normal;
                            font-weight: 400;
                            line-height: 20px;
                        }
                        table.t1 th{
                            border: 2px solid black;
                            text-align: center;
                            background-color: #060ce9;
                            padding: 12px;
                            color: white;
                        }
                        table.t1 td {
                            background-color: #060ce9;
                            align: center;
                            border: 2px solid black;
                            color: yellow;
                            padding: 12px;
                        }
                    </style>

                    <thead align="center">

                    <th th:text="${finalClue[0].category.title}"></th>

                    </thead>

                    <tbody align="center">
                    </tbody>

                </table>

            </div>
        </div>
    </div>

    <div class="panel-group" style="margin-top:20px">

        <div class="panel panel-success" style="float: left; width: 45%">
            <div class="panel-heading">
                High Score: $<span id="highScore" th:text="${admin.high_score}"></span> | Current Score: $<span id="user_score" th:text="${admin.current_score}"></span>
            </div>

            <div class="panel-body">

                <style>
                    .left-half {
                      width: 85%;
                    }
                </style>

                <div class="left-half">

                    <span id="loadAnswer" th:text="${finalClue[0].answer}"></span>

                    <p>Your wager:</p>

                    <input type="number" id="userWager" name="userWager" th:placeholder="your_wager" class="form-control" />
                    <br>

                    <p>Your question - Who / What / Where / When is...</p>

                    <input type="text" id="userAnswer" name="userAnswer" th:placeholder="your_question" class="form-control" />
                    <br>

                </div>
            </div>

            <br>

            <form th:action="@{/admin/gameComplete}" method="get">
                <button name="completeGame" id="save" type="Submit" th:onclick="|checkAnswer();|">Finish your game!</button>
            </form>

        </div>

        <div class="right-half">
            <table class="t2">
                <style>
                                table.t2 {
                                    float: right;
                                    width: 52%;
                                    min-height: 380px;
                                }
                                table.t2 td {
                                    background-color: #060ce9;
                                    font-family: Palatino, URW Palladio L, serif;
                                    color: white;
                                    font-size: 26px;
                                    font-weight: 500;
                                    padding-right: 90px;
                                    padding-left: 90px;
                                    padding-top: 25px;
                                    padding-top: 25px;
                                }
                </style>
                <td id="displayQuestion" align="center" th:text="${finalClue[0].question}"></td>
            </table>
        </div>

    </div>

    <footer>
    <div style="clear: both;"></div>
    </br>
    </footer>


    <script>

                // <![CDATA[

                    (function (global) {
                        document.getElementById("user_score").innerHTML = global.localStorage.getItem("scoreSharer");
                    }(window));

                    (function (global) {
                        document.getElementById("save").addEventListener("click", function () {
                                     global.localStorage.setItem("scoreSharer", document.getElementById("user_score").innerHTML);
                                     global.localStorage.setItem("highScoreSharer", document.getElementById("highScore").innerHTML);
                        }, false);
                    }(window));

                    function addText(question){

                            document.getElementById('displayQuestion').innerHTML=question;
                    }

                    function loadAnswer(answer){

                            document.getElementById('loadAnswer').innerHTML=answer;
                    }

                    function loadCurrentScore(current_score){

                            document.getElementById('loadCurrentScore').innerHTML=current_score;
                    }

                    function checkAnswer(){

                        var actualAnswer = document.getElementById('loadAnswer').innerHTML;
                        var userAnswer = document.getElementById('userAnswer').value;

                        var user_wager = document.getElementById('userWager').value;
                        var updated_score = document.getElementById('user_score').innerHTML;

                        var current_high_score = document.getElementById('highScore').innerHTML;

                        if (userAnswer != actualAnswer){

                            user_score.innerHTML = updated_score - user_wager;
                            window.alert("Wrong. Too bad! | " + userAnswer + " | " + actualAnswer + " | " + user_score.innerHTML + " | " + updated_score + " | " + user_wager + " | " + current_high_score);

                        } else {

                            user_score.innerHTML = ((-1) * ((updated_score * -1) - user_wager));
                            window.alert("Correct! | " + userAnswer + " | " + actualAnswer + " | " + user_score.innerHTML + " | " + updated_score + " | " + user_wager + " | " + current_high_score);

                        }

                        if (user_score.innerHTML > current_high_score){

                            highScore.innerHTML = user_score.innerHTML;

                        }

                    }

                // ]]>
                </script>



</div>

</body>
</html>